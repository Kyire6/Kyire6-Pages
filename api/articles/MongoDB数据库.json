{"title":"MongoDB 数据库","slug":"MongoDB数据库","date":"2020-06-18T01:51:35.000Z","updated":"2020-06-18T01:51:35.000Z","comments":true,"path":"api/articles/MongoDB数据库.json","excerpt":"前言MongoDB 数据库的学习","covers":["https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo.jpg","https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo1.jpg","https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo2.jpg"],"content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a><strong>前言</strong></h2><p>MongoDB 数据库的学习</p>\n<span id=\"more\"></span>\n\n<h2 id=\"MongoDB-的简介\"><a href=\"#MongoDB-的简介\" class=\"headerlink\" title=\"MongoDB 的简介\"></a>MongoDB 的简介</h2><h3 id=\"MongoDB-的概述\"><a href=\"#MongoDB-的概述\" class=\"headerlink\" title=\"MongoDB 的概述\"></a>MongoDB 的概述</h3><p><img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo.jpg\"></p>\n<ul>\n<li>MongoDB 是由 C++语言编写的，是一个基于分布式文件存储的开源数据库系统。</li>\n<li>在高负载的情况下，添加更多的节点，可以保证服务器性能。</li>\n<li>MongoDB 旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。</li>\n<li>MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成</li>\n<li>MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</li>\n</ul>\n<h2 id=\"MongoDB-的安装\"><a href=\"#MongoDB-的安装\" class=\"headerlink\" title=\"MongoDB 的安装\"></a>MongoDB 的安装</h2><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p><code>apt install mongodb</code></p>\n<p>安装完成可以用<code>mongo -version</code>来查看版本检查是否安装成功</p>\n<p><img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo1.jpg\"></p>\n<h3 id=\"MongoDB-基本管理\"><a href=\"#MongoDB-基本管理\" class=\"headerlink\" title=\"MongoDB 基本管理\"></a>MongoDB 基本管理</h3><p>通过以下命令，可以对 mongoDB 数据库进行一些基本的操作：</p>\n<ul>\n<li>查看服务状态<br>service mongodb status</li>\n<li>启动服务<br>service mongodb start</li>\n<li>停止服务<br>service mongodb stop</li>\n<li>重新载入资源<br>service mongodb reload</li>\n</ul>\n<h3 id=\"卸载\"><a href=\"#卸载\" class=\"headerlink\" title=\"卸载\"></a>卸载</h3><p><code>apt --purge remove mongodb mongodb-clients mongodb-server</code></p>\n<h2 id=\"MongoDB-基本配置\"><a href=\"#MongoDB-基本配置\" class=\"headerlink\" title=\"MongoDB 基本配置\"></a>MongoDB 基本配置</h2><h3 id=\"MongoDB-文件结构\"><a href=\"#MongoDB-文件结构\" class=\"headerlink\" title=\"MongoDB 文件结构\"></a>MongoDB 文件结构</h3><p>mongoDB 数据库安装好以后，有以下四个比较重要的文件和目录：</p>\n<ul>\n<li>主启动文件：/usr/bin/mongod</li>\n<li>配置文件：/etc/mongodb.conf</li>\n<li>日志文件存放目录：/var/log/mongodb</li>\n<li>数据存放位置目录：/var/lib/mongodb</li>\n</ul>\n<h2 id=\"MongoDB-基本操作\"><a href=\"#MongoDB-基本操作\" class=\"headerlink\" title=\"MongoDB 基本操作\"></a>MongoDB 基本操作</h2><p>启动 MongoDB 服务后可以进行 MongoDB 的基本操作</p>\n<h3 id=\"连接数据库\"><a href=\"#连接数据库\" class=\"headerlink\" title=\"连接数据库\"></a>连接数据库</h3><p>使用<code>mongo</code>命令连接数据库：</p>\n<p><img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo2.jpg\"></p>\n<h3 id=\"查看已有的数据库\"><a href=\"#查看已有的数据库\" class=\"headerlink\" title=\"查看已有的数据库\"></a>查看已有的数据库</h3><p>使用<code>show dbs</code>命令进行查看：</p>\n<figure class=\"highlight node-repl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">&gt;</span> <span class=\"language-javascript\">show dbs</span></span><br><span class=\"line\">admin   0.000GB</span><br><span class=\"line\">config  0.000GB</span><br><span class=\"line\">local   0.000GB</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用数据库\"><a href=\"#使用数据库\" class=\"headerlink\" title=\"使用数据库\"></a>使用数据库</h3><p>如果使用的数据库不存在，就创建同名数据库：</p>\n<figure class=\"highlight fsharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"operator\">&gt;</span> <span class=\"keyword\">use</span> books</span><br><span class=\"line\">switched <span class=\"keyword\">to</span> db books  <span class=\"comment\">//选中books数据库</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建数据集合\"><a href=\"#创建数据集合\" class=\"headerlink\" title=\"创建数据集合\"></a>创建数据集合</h3><p>类似于一张表，命令为<code>db.createCollection(&quot;表名&quot;)</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.<span class=\"title function_\">createCollection</span>(<span class=\"params\"><span class=\"string\">&quot;user&quot;</span></span>)</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;ok&quot;</span> : <span class=\"number\">1</span> &#125;   <span class=\"comment\">//user创建成功</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"对数据集合进行操作\"><a href=\"#对数据集合进行操作\" class=\"headerlink\" title=\"对数据集合进行操作\"></a>对数据集合进行操作</h3><h4 id=\"插入数据\"><a href=\"#插入数据\" class=\"headerlink\" title=\"插入数据\"></a>插入数据</h4><p>插入命令有两种</p>\n<p><code>db.表名.insert(&#123;&#125;)</code></p>\n<p><code>db.表名.save(&#123;&#125;)</code></p>\n<p>两者区别在于：插入数据时，如果_id 存在，insert 操作时，则插入失败，save 操作时，则更新数据</p>\n<h5 id=\"插入一条数据：\"><a href=\"#插入一条数据：\" class=\"headerlink\" title=\"插入一条数据：\"></a>插入一条数据：</h5><figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.insert</span>(&#123;_id:<span class=\"number\">1</span>,uname:<span class=\"string\">&quot;zhangsan&quot;</span>,age:<span class=\"number\">20</span>,sex:<span class=\"string\">&quot;男&quot;</span>&#125;)</span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">WriteResult</span><span class=\"params\">(&#123; <span class=\"string\">&quot;nInserted&quot;</span> : <span class=\"number\">1</span> &#125;)</span></span>   <span class=\"comment\">//一般情况，第一个字段都是_id,如果没有，也会自动添加一个_id</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"插入多条数据：\"><a href=\"#插入多条数据：\" class=\"headerlink\" title=\"插入多条数据：\"></a>插入多条数据：</h5><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.user.<span class=\"title function_ invoke__\">insert</span>([&#123;<span class=\"attr\">_id</span>:<span class=\"number\">2</span>,<span class=\"attr\">uname</span>:<span class=\"string\">&quot;lisi&quot;</span>,<span class=\"attr\">age</span>:<span class=\"number\">19</span>,<span class=\"attr\">sex</span>:<span class=\"string\">&quot;男&quot;</span>&#125;,&#123;<span class=\"attr\">_id</span>:<span class=\"number\">3</span>,<span class=\"attr\">uname</span>:<span class=\"string\">&quot;wangwu&quot;</span>,<span class=\"attr\">age</span>:<span class=\"number\">18</span>,<span class=\"attr\">sex</span>:<span class=\"string\">&quot;女&quot;</span>&#125;])   <span class=\"comment\">//插入多条数据中间用逗号分开，然后用[]包起来就行</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">BulkWriteResult</span>(&#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;writeErrors&quot;</span> : [ ],</span><br><span class=\"line\">        <span class=\"string\">&quot;writeConcernErrors&quot;</span> : [ ],</span><br><span class=\"line\">        <span class=\"string\">&quot;nInserted&quot;</span> : <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nUpserted&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nMatched&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nModified&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nRemoved&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;upserted&quot;</span> : [ ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查询数据\"><a href=\"#查询数据\" class=\"headerlink\" title=\"查询数据\"></a>查询数据</h4><h5 id=\"不带条件的查询\"><a href=\"#不带条件的查询\" class=\"headerlink\" title=\"不带条件的查询\"></a>不带条件的查询</h5><p>查询命令：<code>db.表名.find()</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.<span class=\"property\">user</span>.<span class=\"title function_\">find</span>(<span class=\"params\"></span>)</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;zhangsan&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">2</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;lisi&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">19</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">3</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;wangwu&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">18</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;女&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"带条件的查询\"><a href=\"#带条件的查询\" class=\"headerlink\" title=\"带条件的查询\"></a>带条件的查询</h5><p>查询命令：<code>db.表名.find(&#123;条件&#125;)</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.user.<span class=\"title function_ invoke__\">find</span>(&#123;<span class=\"attr\">sex</span>:<span class=\"string\">&quot;男&quot;</span>,<span class=\"attr\">uname</span>:<span class=\"string\">&quot;zhangsan&quot;</span>&#125;)  <span class=\"comment\">//支持多条件查询</span></span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;zhangsan&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"更新数据\"><a href=\"#更新数据\" class=\"headerlink\" title=\"更新数据\"></a>更新数据</h4><p>更新命令：<code>db.表名.update(&#123;条件&#125;,&#123;$set:&#123;&#125;&#125;)</code> //这里条件也和查询一样支持多条件</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.update</span>(&#123;_id:<span class=\"number\">1</span>&#125;,&#123;<span class=\"variable\">$set</span>:&#123;uname:<span class=\"string\">&quot;ouwen&quot;</span>&#125;&#125;)  <span class=\"comment\">//把_id为1的uname改为ouwen</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">WriteResult</span><span class=\"params\">(&#123; <span class=\"string\">&quot;nMatched&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;nUpserted&quot;</span> : <span class=\"number\">0</span>, <span class=\"string\">&quot;nModified&quot;</span> : <span class=\"number\">1</span> &#125;)</span></span></span><br><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.find</span>()</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;ouwen&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;  <span class=\"comment\">//修改成功</span></span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">2</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;lisi&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">19</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">3</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;wangwu&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">18</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;女&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"删除数据\"><a href=\"#删除数据\" class=\"headerlink\" title=\"删除数据\"></a>删除数据</h4><p>删除命令：<code>db.表名.remove(&#123;条件&#125;)</code></p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.remove</span>(&#123;uname:<span class=\"string\">&quot;lisi&quot;</span>&#125;) <span class=\"comment\">//删除uname为lisi的数据</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">WriteResult</span><span class=\"params\">(&#123; <span class=\"string\">&quot;nRemoved&quot;</span> : <span class=\"number\">1</span> &#125;)</span></span></span><br><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.find</span>()</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;ouwen&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">3</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;wangwu&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">18</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;女&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查看所有的数据集\"><a href=\"#查看所有的数据集\" class=\"headerlink\" title=\"查看所有的数据集\"></a>查看所有的数据集</h4><p>相当于查看表：<code>show collections</code></p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show collections</span><br><span class=\"line\">user    <span class=\"regexp\">//</span>我这里只有一张表</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"删除数据集合\"><a href=\"#删除数据集合\" class=\"headerlink\" title=\"删除数据集合\"></a>删除数据集合</h4><p>类似于删除表：<code>db.表名.drop()</code></p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.<span class=\"keyword\">user</span>.<span class=\"keyword\">drop</span>()</span><br><span class=\"line\"><span class=\"keyword\">true</span>    //成功删除<span class=\"keyword\">user</span>表</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"删除数据库\"><a href=\"#删除数据库\" class=\"headerlink\" title=\"删除数据库\"></a>删除数据库</h3><p>先使用要删除的数据库：<code>use books</code></p>\n<p>删除命令：<code>db.dropDatabase()</code></p>\n<figure class=\"highlight stata\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">use</span> books   <span class=\"comment\">//使用books数据库</span></span><br><span class=\"line\">switched to <span class=\"keyword\">db</span> books</span><br><span class=\"line\">&gt; <span class=\"keyword\">db</span>.dropDatabase()   <span class=\"comment\">//删除它</span></span><br><span class=\"line\">&#123; <span class=\"string\">&quot;dropped&quot;</span> : <span class=\"string\">&quot;books&quot;</span>, <span class=\"string\">&quot;ok&quot;</span> : 1 &#125;</span><br><span class=\"line\">&gt; show dbs</span><br><span class=\"line\">admin   0.000GB</span><br><span class=\"line\">config  0.000GB</span><br><span class=\"line\"><span class=\"keyword\">local</span>   0.000GB</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"退出数据库连接\"><a href=\"#退出数据库连接\" class=\"headerlink\" title=\"退出数据库连接\"></a>退出数据库连接</h3><p>可以使用<code>Crl+C</code>或者输入<code>exit</code>回车</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">exit</span></span><br><span class=\"line\">bye</span><br><span class=\"line\">root@iZ2ze4ojx7qtz1wv44gajnZ:~<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n","more":"<h2 id=\"MongoDB-的简介\"><a href=\"#MongoDB-的简介\" class=\"headerlink\" title=\"MongoDB 的简介\"></a>MongoDB 的简介</h2><h3 id=\"MongoDB-的概述\"><a href=\"#MongoDB-的概述\" class=\"headerlink\" title=\"MongoDB 的概述\"></a>MongoDB 的概述</h3><p><img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo.jpg\"></p>\n<ul>\n<li>MongoDB 是由 C++语言编写的，是一个基于分布式文件存储的开源数据库系统。</li>\n<li>在高负载的情况下，添加更多的节点，可以保证服务器性能。</li>\n<li>MongoDB 旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。</li>\n<li>MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成</li>\n<li>MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</li>\n</ul>\n<h2 id=\"MongoDB-的安装\"><a href=\"#MongoDB-的安装\" class=\"headerlink\" title=\"MongoDB 的安装\"></a>MongoDB 的安装</h2><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p><code>apt install mongodb</code></p>\n<p>安装完成可以用<code>mongo -version</code>来查看版本检查是否安装成功</p>\n<p><img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo1.jpg\"></p>\n<h3 id=\"MongoDB-基本管理\"><a href=\"#MongoDB-基本管理\" class=\"headerlink\" title=\"MongoDB 基本管理\"></a>MongoDB 基本管理</h3><p>通过以下命令，可以对 mongoDB 数据库进行一些基本的操作：</p>\n<ul>\n<li>查看服务状态<br>service mongodb status</li>\n<li>启动服务<br>service mongodb start</li>\n<li>停止服务<br>service mongodb stop</li>\n<li>重新载入资源<br>service mongodb reload</li>\n</ul>\n<h3 id=\"卸载\"><a href=\"#卸载\" class=\"headerlink\" title=\"卸载\"></a>卸载</h3><p><code>apt --purge remove mongodb mongodb-clients mongodb-server</code></p>\n<h2 id=\"MongoDB-基本配置\"><a href=\"#MongoDB-基本配置\" class=\"headerlink\" title=\"MongoDB 基本配置\"></a>MongoDB 基本配置</h2><h3 id=\"MongoDB-文件结构\"><a href=\"#MongoDB-文件结构\" class=\"headerlink\" title=\"MongoDB 文件结构\"></a>MongoDB 文件结构</h3><p>mongoDB 数据库安装好以后，有以下四个比较重要的文件和目录：</p>\n<ul>\n<li>主启动文件：/usr/bin/mongod</li>\n<li>配置文件：/etc/mongodb.conf</li>\n<li>日志文件存放目录：/var/log/mongodb</li>\n<li>数据存放位置目录：/var/lib/mongodb</li>\n</ul>\n<h2 id=\"MongoDB-基本操作\"><a href=\"#MongoDB-基本操作\" class=\"headerlink\" title=\"MongoDB 基本操作\"></a>MongoDB 基本操作</h2><p>启动 MongoDB 服务后可以进行 MongoDB 的基本操作</p>\n<h3 id=\"连接数据库\"><a href=\"#连接数据库\" class=\"headerlink\" title=\"连接数据库\"></a>连接数据库</h3><p>使用<code>mongo</code>命令连接数据库：</p>\n<p><img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/img/mongo2.jpg\"></p>\n<h3 id=\"查看已有的数据库\"><a href=\"#查看已有的数据库\" class=\"headerlink\" title=\"查看已有的数据库\"></a>查看已有的数据库</h3><p>使用<code>show dbs</code>命令进行查看：</p>\n<figure class=\"highlight node-repl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">&gt;</span> <span class=\"language-javascript\">show dbs</span></span><br><span class=\"line\">admin   0.000GB</span><br><span class=\"line\">config  0.000GB</span><br><span class=\"line\">local   0.000GB</span><br><span class=\"line\"><span class=\"meta prompt_\">&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用数据库\"><a href=\"#使用数据库\" class=\"headerlink\" title=\"使用数据库\"></a>使用数据库</h3><p>如果使用的数据库不存在，就创建同名数据库：</p>\n<figure class=\"highlight fsharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"operator\">&gt;</span> <span class=\"keyword\">use</span> books</span><br><span class=\"line\">switched <span class=\"keyword\">to</span> db books  <span class=\"comment\">//选中books数据库</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建数据集合\"><a href=\"#创建数据集合\" class=\"headerlink\" title=\"创建数据集合\"></a>创建数据集合</h3><p>类似于一张表，命令为<code>db.createCollection(&quot;表名&quot;)</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.<span class=\"title function_\">createCollection</span>(<span class=\"params\"><span class=\"string\">&quot;user&quot;</span></span>)</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;ok&quot;</span> : <span class=\"number\">1</span> &#125;   <span class=\"comment\">//user创建成功</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"对数据集合进行操作\"><a href=\"#对数据集合进行操作\" class=\"headerlink\" title=\"对数据集合进行操作\"></a>对数据集合进行操作</h3><h4 id=\"插入数据\"><a href=\"#插入数据\" class=\"headerlink\" title=\"插入数据\"></a>插入数据</h4><p>插入命令有两种</p>\n<p><code>db.表名.insert(&#123;&#125;)</code></p>\n<p><code>db.表名.save(&#123;&#125;)</code></p>\n<p>两者区别在于：插入数据时，如果_id 存在，insert 操作时，则插入失败，save 操作时，则更新数据</p>\n<h5 id=\"插入一条数据：\"><a href=\"#插入一条数据：\" class=\"headerlink\" title=\"插入一条数据：\"></a>插入一条数据：</h5><figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.insert</span>(&#123;_id:<span class=\"number\">1</span>,uname:<span class=\"string\">&quot;zhangsan&quot;</span>,age:<span class=\"number\">20</span>,sex:<span class=\"string\">&quot;男&quot;</span>&#125;)</span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">WriteResult</span><span class=\"params\">(&#123; <span class=\"string\">&quot;nInserted&quot;</span> : <span class=\"number\">1</span> &#125;)</span></span>   <span class=\"comment\">//一般情况，第一个字段都是_id,如果没有，也会自动添加一个_id</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"插入多条数据：\"><a href=\"#插入多条数据：\" class=\"headerlink\" title=\"插入多条数据：\"></a>插入多条数据：</h5><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.user.<span class=\"title function_ invoke__\">insert</span>([&#123;<span class=\"attr\">_id</span>:<span class=\"number\">2</span>,<span class=\"attr\">uname</span>:<span class=\"string\">&quot;lisi&quot;</span>,<span class=\"attr\">age</span>:<span class=\"number\">19</span>,<span class=\"attr\">sex</span>:<span class=\"string\">&quot;男&quot;</span>&#125;,&#123;<span class=\"attr\">_id</span>:<span class=\"number\">3</span>,<span class=\"attr\">uname</span>:<span class=\"string\">&quot;wangwu&quot;</span>,<span class=\"attr\">age</span>:<span class=\"number\">18</span>,<span class=\"attr\">sex</span>:<span class=\"string\">&quot;女&quot;</span>&#125;])   <span class=\"comment\">//插入多条数据中间用逗号分开，然后用[]包起来就行</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">BulkWriteResult</span>(&#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;writeErrors&quot;</span> : [ ],</span><br><span class=\"line\">        <span class=\"string\">&quot;writeConcernErrors&quot;</span> : [ ],</span><br><span class=\"line\">        <span class=\"string\">&quot;nInserted&quot;</span> : <span class=\"number\">2</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nUpserted&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nMatched&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nModified&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nRemoved&quot;</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;upserted&quot;</span> : [ ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查询数据\"><a href=\"#查询数据\" class=\"headerlink\" title=\"查询数据\"></a>查询数据</h4><h5 id=\"不带条件的查询\"><a href=\"#不带条件的查询\" class=\"headerlink\" title=\"不带条件的查询\"></a>不带条件的查询</h5><p>查询命令：<code>db.表名.find()</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.<span class=\"property\">user</span>.<span class=\"title function_\">find</span>(<span class=\"params\"></span>)</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;zhangsan&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">2</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;lisi&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">19</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">3</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;wangwu&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">18</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;女&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"带条件的查询\"><a href=\"#带条件的查询\" class=\"headerlink\" title=\"带条件的查询\"></a>带条件的查询</h5><p>查询命令：<code>db.表名.find(&#123;条件&#125;)</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.user.<span class=\"title function_ invoke__\">find</span>(&#123;<span class=\"attr\">sex</span>:<span class=\"string\">&quot;男&quot;</span>,<span class=\"attr\">uname</span>:<span class=\"string\">&quot;zhangsan&quot;</span>&#125;)  <span class=\"comment\">//支持多条件查询</span></span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;zhangsan&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"更新数据\"><a href=\"#更新数据\" class=\"headerlink\" title=\"更新数据\"></a>更新数据</h4><p>更新命令：<code>db.表名.update(&#123;条件&#125;,&#123;$set:&#123;&#125;&#125;)</code> //这里条件也和查询一样支持多条件</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.update</span>(&#123;_id:<span class=\"number\">1</span>&#125;,&#123;<span class=\"variable\">$set</span>:&#123;uname:<span class=\"string\">&quot;ouwen&quot;</span>&#125;&#125;)  <span class=\"comment\">//把_id为1的uname改为ouwen</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">WriteResult</span><span class=\"params\">(&#123; <span class=\"string\">&quot;nMatched&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;nUpserted&quot;</span> : <span class=\"number\">0</span>, <span class=\"string\">&quot;nModified&quot;</span> : <span class=\"number\">1</span> &#125;)</span></span></span><br><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.find</span>()</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;ouwen&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;  <span class=\"comment\">//修改成功</span></span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">2</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;lisi&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">19</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">3</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;wangwu&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">18</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;女&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"删除数据\"><a href=\"#删除数据\" class=\"headerlink\" title=\"删除数据\"></a>删除数据</h4><p>删除命令：<code>db.表名.remove(&#123;条件&#125;)</code></p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.remove</span>(&#123;uname:<span class=\"string\">&quot;lisi&quot;</span>&#125;) <span class=\"comment\">//删除uname为lisi的数据</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">WriteResult</span><span class=\"params\">(&#123; <span class=\"string\">&quot;nRemoved&quot;</span> : <span class=\"number\">1</span> &#125;)</span></span></span><br><span class=\"line\">&gt; db<span class=\"selector-class\">.user</span><span class=\"selector-class\">.find</span>()</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">1</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;ouwen&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">20</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;男&quot;</span> &#125;</span><br><span class=\"line\">&#123; <span class=\"string\">&quot;_id&quot;</span> : <span class=\"number\">3</span>, <span class=\"string\">&quot;uname&quot;</span> : <span class=\"string\">&quot;wangwu&quot;</span>, <span class=\"string\">&quot;age&quot;</span> : <span class=\"number\">18</span>, <span class=\"string\">&quot;sex&quot;</span> : <span class=\"string\">&quot;女&quot;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查看所有的数据集\"><a href=\"#查看所有的数据集\" class=\"headerlink\" title=\"查看所有的数据集\"></a>查看所有的数据集</h4><p>相当于查看表：<code>show collections</code></p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show collections</span><br><span class=\"line\">user    <span class=\"regexp\">//</span>我这里只有一张表</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"删除数据集合\"><a href=\"#删除数据集合\" class=\"headerlink\" title=\"删除数据集合\"></a>删除数据集合</h4><p>类似于删除表：<code>db.表名.drop()</code></p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; db.<span class=\"keyword\">user</span>.<span class=\"keyword\">drop</span>()</span><br><span class=\"line\"><span class=\"keyword\">true</span>    //成功删除<span class=\"keyword\">user</span>表</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"删除数据库\"><a href=\"#删除数据库\" class=\"headerlink\" title=\"删除数据库\"></a>删除数据库</h3><p>先使用要删除的数据库：<code>use books</code></p>\n<p>删除命令：<code>db.dropDatabase()</code></p>\n<figure class=\"highlight stata\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">use</span> books   <span class=\"comment\">//使用books数据库</span></span><br><span class=\"line\">switched to <span class=\"keyword\">db</span> books</span><br><span class=\"line\">&gt; <span class=\"keyword\">db</span>.dropDatabase()   <span class=\"comment\">//删除它</span></span><br><span class=\"line\">&#123; <span class=\"string\">&quot;dropped&quot;</span> : <span class=\"string\">&quot;books&quot;</span>, <span class=\"string\">&quot;ok&quot;</span> : 1 &#125;</span><br><span class=\"line\">&gt; show dbs</span><br><span class=\"line\">admin   0.000GB</span><br><span class=\"line\">config  0.000GB</span><br><span class=\"line\"><span class=\"keyword\">local</span>   0.000GB</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"退出数据库连接\"><a href=\"#退出数据库连接\" class=\"headerlink\" title=\"退出数据库连接\"></a>退出数据库连接</h3><p>可以使用<code>Crl+C</code>或者输入<code>exit</code>回车</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">exit</span></span><br><span class=\"line\">bye</span><br><span class=\"line\">root@iZ2ze4ojx7qtz1wv44gajnZ:~<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>","categories":[{"name":"中间件","path":"api/categories/中间件.json"}],"tags":[{"name":"笔记","path":"api/tags/笔记.json"},{"name":"MongoDB","path":"api/tags/MongoDB.json"}]}