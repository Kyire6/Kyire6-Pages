{"title":"Java 操作 Excel 之 POI 与 EasyExcel","slug":"Java操作Excel之POI与EasyExcel","date":"2021-08-05T08:25:44.000Z","updated":"2021-08-05T08:26:26.000Z","comments":true,"path":"api/articles/Java操作Excel之POI与EasyExcel.json","excerpt":null,"covers":["https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/20210622175140.png","https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/20210622175228.png"],"content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在工作中，使用 excel 表格处理数据是很常见的操作，作为一个 Java 开发工程师，学会使用 Java 来操作 excel 表格是必备的技能之一。</p>\n<p>本文就通过市面上常用的两种方式来实现 Java 对 excel 表格的操作：</p>\n<ul>\n<li>Apache POI</li>\n<li>Alibaba EasyExcel</li>\n</ul>\n<h2 id=\"一、Apache-POI\"><a href=\"#一、Apache-POI\" class=\"headerlink\" title=\"一、Apache POI\"></a>一、Apache POI</h2><h3 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h3><p>Apache POI 官网： <a href=\"https://poi.apache.org/\">https://poi.apache.org/</a></p>\n<p>POI 是目前比较流行的 Java 处理 excel 框架，但是其缺点是 <strong>数据量大容易造成 OOM 异常</strong></p>\n<h3 id=\"基本结构\"><a href=\"#基本结构\" class=\"headerlink\" title=\"基本结构\"></a>基本结构</h3><ul>\n<li>HSSF － 提供读写[Microsoft Excel](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> Excel)格式档案的功能（03 版本 excel）</li>\n<li>XSSF － 提供读写<a href=\"https://baike.baidu.com/item/Microsoft\">Microsoft</a> Excel <a href=\"https://baike.baidu.com/item/OOXML\">OOXML</a>格式档案的功能（07 版本 excel）</li>\n<li>HWPF － 提供读写[Microsoft Word](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> Word)格式档案的功能</li>\n<li>HSLF － 提供读写[Microsoft PowerPoint](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> PowerPoint)格式档案的功能</li>\n<li>HDGF － 提供读写[Microsoft Visio](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> Visio)格式档案的功能</li>\n</ul>\n<h3 id=\"快速开始\"><a href=\"#快速开始\" class=\"headerlink\" title=\"快速开始\"></a>快速开始</h3><p>创建 一个空项目，在空项目中新建一个 module 模块：一个普通的 maven 项目即可</p>\n<h4 id=\"1、导入-pom-依赖\"><a href=\"#1、导入-pom-依赖\" class=\"headerlink\" title=\"1、导入 pom 依赖\"></a>1、导入 pom 依赖</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--xLs(03)--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.poi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>poi<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--xLsx(07)--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.poi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>poi-ooxml<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--日期格式化工具--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>joda-time<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>joda-time<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.10.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--test--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.12<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2、POI-写入-Excel\"><a href=\"#2、POI-写入-Excel\" class=\"headerlink\" title=\"2、POI 写入 Excel\"></a>2、POI 写入 Excel</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Row;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.joda.time.DateTime;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * POI写入Excel测试</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 14:20</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">WriteExcelTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-poi\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 写入03版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testWrite03</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 创建工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HSSFWorkbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.createSheet(<span class=\"string\">&quot;员工信息表03&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第一行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row1</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell11</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell11.setCellValue(<span class=\"string\">&quot;姓名&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell12</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell12.setCellValue(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第二行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row2</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell21</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell21.setCellValue(<span class=\"string\">&quot;出生日期&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell22</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell22.setCellValue(<span class=\"keyword\">new</span> <span class=\"title class_\">DateTime</span>().toString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 生成表 io流 -- 03版本使用xls后缀名</span></span><br><span class=\"line\">        <span class=\"type\">FileOutputStream</span> <span class=\"variable\">fileOutputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(PATH + <span class=\"string\">&quot;员工信息表03.xls&quot;</span>);</span><br><span class=\"line\">        workbook.write(fileOutputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 关闭流</span></span><br><span class=\"line\">        fileOutputStream.close();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;员工信息表03.xls ==&gt; 输出完毕&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 写入07版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testWrite07</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 创建工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">XSSFWorkbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.createSheet(<span class=\"string\">&quot;员工信息表07&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第一行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row1</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell11</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell11.setCellValue(<span class=\"string\">&quot;姓名&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell12</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell12.setCellValue(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第二行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row2</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell21</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell21.setCellValue(<span class=\"string\">&quot;出生日期&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell22</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell22.setCellValue(<span class=\"keyword\">new</span> <span class=\"title class_\">DateTime</span>().toString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 生成表 io流 -- 07版本使用xlsx后缀名</span></span><br><span class=\"line\">        <span class=\"type\">FileOutputStream</span> <span class=\"variable\">fileOutputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(PATH + <span class=\"string\">&quot;员工信息表07.xlsx&quot;</span>);</span><br><span class=\"line\">        workbook.write(fileOutputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 关闭流</span></span><br><span class=\"line\">        fileOutputStream.close();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;员工信息表07.xls ==&gt; 输出完毕&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、POI-读取-Excel\"><a href=\"#3、POI-读取-Excel\" class=\"headerlink\" title=\"3、POI 读取 Excel\"></a>3、POI 读取 Excel</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Row;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileInputStream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * POI读取Excel测试</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 15:49</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ReadExcelTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-poi\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 读取03版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testRead03</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过文件路径得到文件输入流</span></span><br><span class=\"line\">        <span class=\"type\">FileInputStream</span> <span class=\"variable\">fileInputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(PATH + <span class=\"string\">&quot;员工信息表03.xls&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过文件输入流拿到工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HSSFWorkbook</span>(fileInputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过工作簿获取工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.getSheetAt(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 拿到行数，通过循环读取数据</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rowCount</span> <span class=\"operator\">=</span> sheet.getPhysicalNumberOfRows();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">rowNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; rowNum &lt; rowCount; rowNum++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 通过工作表读取行，并取到对应的列数</span></span><br><span class=\"line\">            <span class=\"type\">Row</span> <span class=\"variable\">row</span> <span class=\"operator\">=</span> sheet.getRow(rowNum);</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">cellCount</span> <span class=\"operator\">=</span> row.getPhysicalNumberOfCells();</span><br><span class=\"line\">            <span class=\"comment\">// 通过行读取单元格</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">cellNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; cellNum &lt; cellCount; cellNum++) &#123;</span><br><span class=\"line\">                <span class=\"type\">Cell</span> <span class=\"variable\">cell</span> <span class=\"operator\">=</span> row.getCell(cellNum);</span><br><span class=\"line\">                <span class=\"comment\">// 读取 excel 表格中的数据时要注意类型</span></span><br><span class=\"line\">                System.out.print(cell.getStringCellValue()+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 读取07版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testRead07</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过文件路径得到文件输入流</span></span><br><span class=\"line\">        <span class=\"type\">FileInputStream</span> <span class=\"variable\">fileInputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(PATH + <span class=\"string\">&quot;员工信息表07.xlsx&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过文件输入流拿到工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">XSSFWorkbook</span>(fileInputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过工作簿获取工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.getSheetAt(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 拿到行数，通过循环读取数据</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rowCount</span> <span class=\"operator\">=</span> sheet.getPhysicalNumberOfRows();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">rowNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; rowNum &lt; rowCount; rowNum++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 通过工作表读取行，并取到对应的列数</span></span><br><span class=\"line\">            <span class=\"type\">Row</span> <span class=\"variable\">row</span> <span class=\"operator\">=</span> sheet.getRow(rowNum);</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">cellCount</span> <span class=\"operator\">=</span> row.getPhysicalNumberOfCells();</span><br><span class=\"line\">            <span class=\"comment\">// 通过行读取单元格</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">cellNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; cellNum &lt; cellCount; cellNum++) &#123;</span><br><span class=\"line\">                <span class=\"type\">Cell</span> <span class=\"variable\">cell</span> <span class=\"operator\">=</span> row.getCell(cellNum);</span><br><span class=\"line\">                <span class=\"comment\">// 读取 excel 表格中的数据时要注意类型</span></span><br><span class=\"line\">                System.out.print(cell.getStringCellValue()+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"注意：\"><a href=\"#注意：\" class=\"headerlink\" title=\"注意：\"></a>注意：</h4><ul>\n<li><code>03</code> 和 <code>07</code> 版本的 <code>excel</code> 表格对应的 POI 操作 API 是不同的（<code>HSSF</code> 与 <code>XSSF</code>）<ul>\n<li><code>03</code> 版本最多支持 <code>65536</code> 行数据，而 <code>07</code> 则没有限制</li>\n<li><code>HSSF</code> 操作响应速度快于 <code>XSSF</code>， <code>XSSF</code>可以使用 <code>SXSSF</code> 替换来提升响应数据</li>\n</ul>\n</li>\n<li>==读取 <code>excel</code> 表格中的数据时要注意判断不同的数据类型，使用对应的读取方法==</li>\n</ul>\n<p>最终的项目目录结构：</p>\n<img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/20210622175140.png\" alt=\"image-20210622175133621\" style=\"zoom:50%;\" />\n\n<h2 id=\"二、EasyExcel\"><a href=\"#二、EasyExcel\" class=\"headerlink\" title=\"二、EasyExcel\"></a>二、EasyExcel</h2><h3 id=\"简介-1\"><a href=\"#简介-1\" class=\"headerlink\" title=\"简介\"></a>简介</h3><p>EasyExcel 官网地址：<a href=\"https://github.com/alibaba/easyexcel\">https://github.com/alibaba/easyexcel</a></p>\n<p>EasyExcel 是 Alibaba 开源的一个 excel 处理框架，特点是 <strong>使用简单、节约内存</strong>。</p>\n<h3 id=\"快速开始-1\"><a href=\"#快速开始-1\" class=\"headerlink\" title=\"快速开始\"></a>快速开始</h3><p>在空项目中新建一个新的 module 模块，类型为普通的 maven 项目</p>\n<h4 id=\"1、导入-pom-依赖-1\"><a href=\"#1、导入-pom-依赖-1\" class=\"headerlink\" title=\"1、导入 pom 依赖\"></a>1、导入 pom 依赖</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 导入easyexcel依赖 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>easyexcel<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.10<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- lombok依赖 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.18.16<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- junit单元测试 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.jupiter<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-jupiter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>compile<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- json工具 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>fastjson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.2.72<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2、数据实体对象\"><a href=\"#2、数据实体对象\" class=\"headerlink\" title=\"2、数据实体对象\"></a>2、数据实体对象</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.annotation.ExcelIgnore;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.annotation.ExcelProperty;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoData</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@ExcelProperty(&quot;字符串标题&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String string;</span><br><span class=\"line\">    <span class=\"meta\">@ExcelProperty(&quot;日期标题&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date date;</span><br><span class=\"line\">    <span class=\"meta\">@ExcelProperty(&quot;数字标题&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Double doubleData;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 忽略这个字段</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ExcelIgnore</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String ignore;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、EasyExcel-写入-Excel\"><a href=\"#3、EasyExcel-写入-Excel\" class=\"headerlink\" title=\"3、EasyExcel 写入 Excel\"></a>3、EasyExcel 写入 Excel</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.EasyExcel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.jupiter.api.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 16:41</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">EasyExcelWrite</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-easyexcel\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 生成示例数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 示例数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;DemoData&gt; <span class=\"title function_\">data</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        List&lt;DemoData&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;DemoData&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">DemoData</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DemoData</span>();</span><br><span class=\"line\">            data.setString(<span class=\"string\">&quot;字符串&quot;</span> + i);</span><br><span class=\"line\">            data.setDate(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">            data.setDoubleData(<span class=\"number\">0.56</span>);</span><br><span class=\"line\">            list.add(data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 最简单的写</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class=\"doctag\">@link</span> DemoData&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;2. 直接写即可</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">simpleWrite</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> PATH + <span class=\"string\">&quot;easyexcel07.xlsx&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果这里想使用 03版本 则 传入excelType参数即可</span></span><br><span class=\"line\">        EasyExcel.write(fileName, DemoData.class).sheet(<span class=\"string\">&quot;模板&quot;</span>).doWrite(data());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4、EasyExcel-读取-Excel\"><a href=\"#4、EasyExcel-读取-Excel\" class=\"headerlink\" title=\"4、EasyExcel 读取 Excel\"></a>4、EasyExcel 读取 Excel</h4><p>数据持久层：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 假设这个是你的DAO存储。当然还要这个类让spring管理，当然你不用需要存储，也不需要这个类。</span></span><br><span class=\"line\"><span class=\"comment\"> **/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoDAO</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">(List&lt;DemoData&gt; list)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 如果是mybatis,尽量别直接调用多次insert,自己写一个mapper里面新增一个方法batchInsert,所有数据一次性插入</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>读取监听器：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.context.AnalysisContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.event.AnalysisEventListener;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSON;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.slf4j.Logger;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.slf4j.LoggerFactory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoDataListener</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AnalysisEventListener</span>&lt;DemoData&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Logger</span> <span class=\"variable\">LOGGER</span> <span class=\"operator\">=</span> LoggerFactory.getLogger(DemoDataListener.class);</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 每隔5条存储数据库，实际使用中可以3000条，然后清理list ，方便内存回收</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">BATCH_COUNT</span> <span class=\"operator\">=</span> <span class=\"number\">5</span>;</span><br><span class=\"line\">    List&lt;DemoData&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;DemoData&gt;();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 假设这个是一个DAO，当然有业务逻辑这个也可以是一个service。当然如果不用存储这个对象没用。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DemoDAO demoDAO;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">DemoDataListener</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里是demo，所以随便new一个。实际使用如果到了spring,请使用下面的有参构造函数</span></span><br><span class=\"line\">        demoDAO = <span class=\"keyword\">new</span> <span class=\"title class_\">DemoDAO</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">DemoDataListener</span><span class=\"params\">(DemoDAO demoDAO)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.demoDAO = demoDAO;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 这个每一条数据解析都会来调用</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data</span></span><br><span class=\"line\"><span class=\"comment\">     *            one row value. Is is same as &#123;<span class=\"doctag\">@link</span> AnalysisContext#readRowHolder()&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> context</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">invoke</span><span class=\"params\">(DemoData data, AnalysisContext context)</span> &#123;</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;解析到一条数据:&#123;&#125;&quot;</span>, JSON.toJSONString(data));</span><br><span class=\"line\">        System.out.println(JSON.toJSONString(data));</span><br><span class=\"line\">        list.add(data);</span><br><span class=\"line\">        <span class=\"comment\">// 达到BATCH_COUNT了，需要去存储一次数据库，防止数据几万条数据在内存，容易OOM</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (list.size() &gt;= BATCH_COUNT) &#123;</span><br><span class=\"line\">            saveData();</span><br><span class=\"line\">            <span class=\"comment\">// 存储完成清理 list</span></span><br><span class=\"line\">            list.clear();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 所有数据解析完成了 都会来调用</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> context</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfterAllAnalysed</span><span class=\"params\">(AnalysisContext context)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里也要保存数据，确保最后遗留的数据也存储到数据库</span></span><br><span class=\"line\">        saveData();</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;所有数据解析完成！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 加上存储数据库</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">saveData</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;&#123;&#125;条数据，开始存储数据库！&quot;</span>, list.size());</span><br><span class=\"line\">        demoDAO.save(list);</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;存储数据库成功！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>读取测试：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.EasyExcel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.ExcelReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.read.metadata.ReadSheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.jupiter.api.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 16:57</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">EasyExcelRead</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-easyexcel\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 最简单的读</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class=\"doctag\">@link</span> DemoData&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class=\"doctag\">@link</span> DemoDataListener&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;3. 直接读即可</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">simpleRead</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> PATH + <span class=\"string\">&quot;easyexcel07.xlsx&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span></span><br><span class=\"line\">        EasyExcel.read(fileName, DemoData.class, <span class=\"keyword\">new</span> <span class=\"title class_\">DemoDataListener</span>()).sheet().doRead();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"注意：-1\"><a href=\"#注意：-1\" class=\"headerlink\" title=\"注意：\"></a>注意：</h4><ul>\n<li>如果需要操作 <code>03</code> 版本的 <code>excel</code>，需要在读写操作时传入 <code>excelType</code> 参数</li>\n</ul>\n<p>最终的项目结构：</p>\n<img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/20210622175228.png\" alt=\"image-20210622175227995\" style=\"zoom:50%;\" />\n","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在工作中，使用 excel 表格处理数据是很常见的操作，作为一个 Java 开发工程师，学会使用 Java 来操作 excel 表格是必备的技能之一。</p>\n<p>本文就通过市面上常用的两种方式来实现 Java 对 excel 表格的操作：</p>\n<ul>\n<li>Apache POI</li>\n<li>Alibaba EasyExcel</li>\n</ul>\n<h2 id=\"一、Apache-POI\"><a href=\"#一、Apache-POI\" class=\"headerlink\" title=\"一、Apache POI\"></a>一、Apache POI</h2><h3 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h3><p>Apache POI 官网： <a href=\"https://poi.apache.org/\">https://poi.apache.org/</a></p>\n<p>POI 是目前比较流行的 Java 处理 excel 框架，但是其缺点是 <strong>数据量大容易造成 OOM 异常</strong></p>\n<h3 id=\"基本结构\"><a href=\"#基本结构\" class=\"headerlink\" title=\"基本结构\"></a>基本结构</h3><ul>\n<li>HSSF － 提供读写[Microsoft Excel](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> Excel)格式档案的功能（03 版本 excel）</li>\n<li>XSSF － 提供读写<a href=\"https://baike.baidu.com/item/Microsoft\">Microsoft</a> Excel <a href=\"https://baike.baidu.com/item/OOXML\">OOXML</a>格式档案的功能（07 版本 excel）</li>\n<li>HWPF － 提供读写[Microsoft Word](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> Word)格式档案的功能</li>\n<li>HSLF － 提供读写[Microsoft PowerPoint](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> PowerPoint)格式档案的功能</li>\n<li>HDGF － 提供读写[Microsoft Visio](<a href=\"https://baike.baidu.com/item/Microsoft\">https://baike.baidu.com/item/Microsoft</a> Visio)格式档案的功能</li>\n</ul>\n<h3 id=\"快速开始\"><a href=\"#快速开始\" class=\"headerlink\" title=\"快速开始\"></a>快速开始</h3><p>创建 一个空项目，在空项目中新建一个 module 模块：一个普通的 maven 项目即可</p>\n<h4 id=\"1、导入-pom-依赖\"><a href=\"#1、导入-pom-依赖\" class=\"headerlink\" title=\"1、导入 pom 依赖\"></a>1、导入 pom 依赖</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--xLs(03)--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.poi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>poi<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--xLsx(07)--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.poi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>poi-ooxml<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--日期格式化工具--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>joda-time<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>joda-time<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.10.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--test--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.12<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2、POI-写入-Excel\"><a href=\"#2、POI-写入-Excel\" class=\"headerlink\" title=\"2、POI 写入 Excel\"></a>2、POI 写入 Excel</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Row;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.joda.time.DateTime;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * POI写入Excel测试</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 14:20</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">WriteExcelTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-poi\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 写入03版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testWrite03</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 创建工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HSSFWorkbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.createSheet(<span class=\"string\">&quot;员工信息表03&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第一行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row1</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell11</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell11.setCellValue(<span class=\"string\">&quot;姓名&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell12</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell12.setCellValue(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第二行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row2</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell21</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell21.setCellValue(<span class=\"string\">&quot;出生日期&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell22</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell22.setCellValue(<span class=\"keyword\">new</span> <span class=\"title class_\">DateTime</span>().toString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 生成表 io流 -- 03版本使用xls后缀名</span></span><br><span class=\"line\">        <span class=\"type\">FileOutputStream</span> <span class=\"variable\">fileOutputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(PATH + <span class=\"string\">&quot;员工信息表03.xls&quot;</span>);</span><br><span class=\"line\">        workbook.write(fileOutputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 关闭流</span></span><br><span class=\"line\">        fileOutputStream.close();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;员工信息表03.xls ==&gt; 输出完毕&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 写入07版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testWrite07</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 创建工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">XSSFWorkbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.createSheet(<span class=\"string\">&quot;员工信息表07&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第一行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row1</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell11</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell11.setCellValue(<span class=\"string\">&quot;姓名&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell12</span> <span class=\"operator\">=</span> row1.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell12.setCellValue(<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 创建第二行</span></span><br><span class=\"line\">        <span class=\"type\">Row</span> <span class=\"variable\">row2</span> <span class=\"operator\">=</span> sheet.createRow(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建单元格</span></span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell21</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">0</span>);</span><br><span class=\"line\">        cell21.setCellValue(<span class=\"string\">&quot;出生日期&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Cell</span> <span class=\"variable\">cell22</span> <span class=\"operator\">=</span> row2.createCell(<span class=\"number\">1</span>);</span><br><span class=\"line\">        cell22.setCellValue(<span class=\"keyword\">new</span> <span class=\"title class_\">DateTime</span>().toString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 生成表 io流 -- 07版本使用xlsx后缀名</span></span><br><span class=\"line\">        <span class=\"type\">FileOutputStream</span> <span class=\"variable\">fileOutputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(PATH + <span class=\"string\">&quot;员工信息表07.xlsx&quot;</span>);</span><br><span class=\"line\">        workbook.write(fileOutputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 关闭流</span></span><br><span class=\"line\">        fileOutputStream.close();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;员工信息表07.xls ==&gt; 输出完毕&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、POI-读取-Excel\"><a href=\"#3、POI-读取-Excel\" class=\"headerlink\" title=\"3、POI 读取 Excel\"></a>3、POI 读取 Excel</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Row;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileInputStream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * POI读取Excel测试</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 15:49</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ReadExcelTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-poi\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 读取03版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testRead03</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过文件路径得到文件输入流</span></span><br><span class=\"line\">        <span class=\"type\">FileInputStream</span> <span class=\"variable\">fileInputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(PATH + <span class=\"string\">&quot;员工信息表03.xls&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过文件输入流拿到工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HSSFWorkbook</span>(fileInputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过工作簿获取工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.getSheetAt(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 拿到行数，通过循环读取数据</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rowCount</span> <span class=\"operator\">=</span> sheet.getPhysicalNumberOfRows();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">rowNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; rowNum &lt; rowCount; rowNum++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 通过工作表读取行，并取到对应的列数</span></span><br><span class=\"line\">            <span class=\"type\">Row</span> <span class=\"variable\">row</span> <span class=\"operator\">=</span> sheet.getRow(rowNum);</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">cellCount</span> <span class=\"operator\">=</span> row.getPhysicalNumberOfCells();</span><br><span class=\"line\">            <span class=\"comment\">// 通过行读取单元格</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">cellNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; cellNum &lt; cellCount; cellNum++) &#123;</span><br><span class=\"line\">                <span class=\"type\">Cell</span> <span class=\"variable\">cell</span> <span class=\"operator\">=</span> row.getCell(cellNum);</span><br><span class=\"line\">                <span class=\"comment\">// 读取 excel 表格中的数据时要注意类型</span></span><br><span class=\"line\">                System.out.print(cell.getStringCellValue()+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 读取07版本的excel</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testRead07</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过文件路径得到文件输入流</span></span><br><span class=\"line\">        <span class=\"type\">FileInputStream</span> <span class=\"variable\">fileInputStream</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(PATH + <span class=\"string\">&quot;员工信息表07.xlsx&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过文件输入流拿到工作簿</span></span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">XSSFWorkbook</span>(fileInputStream);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过工作簿获取工作表</span></span><br><span class=\"line\">        <span class=\"type\">Sheet</span> <span class=\"variable\">sheet</span> <span class=\"operator\">=</span> workbook.getSheetAt(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 拿到行数，通过循环读取数据</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rowCount</span> <span class=\"operator\">=</span> sheet.getPhysicalNumberOfRows();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">rowNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; rowNum &lt; rowCount; rowNum++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 通过工作表读取行，并取到对应的列数</span></span><br><span class=\"line\">            <span class=\"type\">Row</span> <span class=\"variable\">row</span> <span class=\"operator\">=</span> sheet.getRow(rowNum);</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">cellCount</span> <span class=\"operator\">=</span> row.getPhysicalNumberOfCells();</span><br><span class=\"line\">            <span class=\"comment\">// 通过行读取单元格</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">cellNum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; cellNum &lt; cellCount; cellNum++) &#123;</span><br><span class=\"line\">                <span class=\"type\">Cell</span> <span class=\"variable\">cell</span> <span class=\"operator\">=</span> row.getCell(cellNum);</span><br><span class=\"line\">                <span class=\"comment\">// 读取 excel 表格中的数据时要注意类型</span></span><br><span class=\"line\">                System.out.print(cell.getStringCellValue()+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"注意：\"><a href=\"#注意：\" class=\"headerlink\" title=\"注意：\"></a>注意：</h4><ul>\n<li><code>03</code> 和 <code>07</code> 版本的 <code>excel</code> 表格对应的 POI 操作 API 是不同的（<code>HSSF</code> 与 <code>XSSF</code>）<ul>\n<li><code>03</code> 版本最多支持 <code>65536</code> 行数据，而 <code>07</code> 则没有限制</li>\n<li><code>HSSF</code> 操作响应速度快于 <code>XSSF</code>， <code>XSSF</code>可以使用 <code>SXSSF</code> 替换来提升响应数据</li>\n</ul>\n</li>\n<li>==读取 <code>excel</code> 表格中的数据时要注意判断不同的数据类型，使用对应的读取方法==</li>\n</ul>\n<p>最终的项目目录结构：</p>\n<img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/20210622175140.png\" alt=\"image-20210622175133621\" style=\"zoom:50%;\" />\n\n<h2 id=\"二、EasyExcel\"><a href=\"#二、EasyExcel\" class=\"headerlink\" title=\"二、EasyExcel\"></a>二、EasyExcel</h2><h3 id=\"简介-1\"><a href=\"#简介-1\" class=\"headerlink\" title=\"简介\"></a>简介</h3><p>EasyExcel 官网地址：<a href=\"https://github.com/alibaba/easyexcel\">https://github.com/alibaba/easyexcel</a></p>\n<p>EasyExcel 是 Alibaba 开源的一个 excel 处理框架，特点是 <strong>使用简单、节约内存</strong>。</p>\n<h3 id=\"快速开始-1\"><a href=\"#快速开始-1\" class=\"headerlink\" title=\"快速开始\"></a>快速开始</h3><p>在空项目中新建一个新的 module 模块，类型为普通的 maven 项目</p>\n<h4 id=\"1、导入-pom-依赖-1\"><a href=\"#1、导入-pom-依赖-1\" class=\"headerlink\" title=\"1、导入 pom 依赖\"></a>1、导入 pom 依赖</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 导入easyexcel依赖 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>easyexcel<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.10<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- lombok依赖 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.18.16<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- junit单元测试 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.jupiter<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-jupiter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>compile<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- json工具 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>fastjson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.2.72<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2、数据实体对象\"><a href=\"#2、数据实体对象\" class=\"headerlink\" title=\"2、数据实体对象\"></a>2、数据实体对象</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.annotation.ExcelIgnore;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.annotation.ExcelProperty;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoData</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@ExcelProperty(&quot;字符串标题&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String string;</span><br><span class=\"line\">    <span class=\"meta\">@ExcelProperty(&quot;日期标题&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date date;</span><br><span class=\"line\">    <span class=\"meta\">@ExcelProperty(&quot;数字标题&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Double doubleData;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 忽略这个字段</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ExcelIgnore</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String ignore;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、EasyExcel-写入-Excel\"><a href=\"#3、EasyExcel-写入-Excel\" class=\"headerlink\" title=\"3、EasyExcel 写入 Excel\"></a>3、EasyExcel 写入 Excel</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.EasyExcel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.jupiter.api.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 16:41</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">EasyExcelWrite</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-easyexcel\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 生成示例数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 示例数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;DemoData&gt; <span class=\"title function_\">data</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        List&lt;DemoData&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;DemoData&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">DemoData</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DemoData</span>();</span><br><span class=\"line\">            data.setString(<span class=\"string\">&quot;字符串&quot;</span> + i);</span><br><span class=\"line\">            data.setDate(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">            data.setDoubleData(<span class=\"number\">0.56</span>);</span><br><span class=\"line\">            list.add(data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 最简单的写</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class=\"doctag\">@link</span> DemoData&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;2. 直接写即可</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">simpleWrite</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> PATH + <span class=\"string\">&quot;easyexcel07.xlsx&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果这里想使用 03版本 则 传入excelType参数即可</span></span><br><span class=\"line\">        EasyExcel.write(fileName, DemoData.class).sheet(<span class=\"string\">&quot;模板&quot;</span>).doWrite(data());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4、EasyExcel-读取-Excel\"><a href=\"#4、EasyExcel-读取-Excel\" class=\"headerlink\" title=\"4、EasyExcel 读取 Excel\"></a>4、EasyExcel 读取 Excel</h4><p>数据持久层：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 假设这个是你的DAO存储。当然还要这个类让spring管理，当然你不用需要存储，也不需要这个类。</span></span><br><span class=\"line\"><span class=\"comment\"> **/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoDAO</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">(List&lt;DemoData&gt; list)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 如果是mybatis,尽量别直接调用多次insert,自己写一个mapper里面新增一个方法batchInsert,所有数据一次性插入</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>读取监听器：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.context.AnalysisContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.event.AnalysisEventListener;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSON;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.slf4j.Logger;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.slf4j.LoggerFactory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DemoDataListener</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AnalysisEventListener</span>&lt;DemoData&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Logger</span> <span class=\"variable\">LOGGER</span> <span class=\"operator\">=</span> LoggerFactory.getLogger(DemoDataListener.class);</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 每隔5条存储数据库，实际使用中可以3000条，然后清理list ，方便内存回收</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">BATCH_COUNT</span> <span class=\"operator\">=</span> <span class=\"number\">5</span>;</span><br><span class=\"line\">    List&lt;DemoData&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;DemoData&gt;();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 假设这个是一个DAO，当然有业务逻辑这个也可以是一个service。当然如果不用存储这个对象没用。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DemoDAO demoDAO;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">DemoDataListener</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里是demo，所以随便new一个。实际使用如果到了spring,请使用下面的有参构造函数</span></span><br><span class=\"line\">        demoDAO = <span class=\"keyword\">new</span> <span class=\"title class_\">DemoDAO</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">DemoDataListener</span><span class=\"params\">(DemoDAO demoDAO)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.demoDAO = demoDAO;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 这个每一条数据解析都会来调用</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data</span></span><br><span class=\"line\"><span class=\"comment\">     *            one row value. Is is same as &#123;<span class=\"doctag\">@link</span> AnalysisContext#readRowHolder()&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> context</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">invoke</span><span class=\"params\">(DemoData data, AnalysisContext context)</span> &#123;</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;解析到一条数据:&#123;&#125;&quot;</span>, JSON.toJSONString(data));</span><br><span class=\"line\">        System.out.println(JSON.toJSONString(data));</span><br><span class=\"line\">        list.add(data);</span><br><span class=\"line\">        <span class=\"comment\">// 达到BATCH_COUNT了，需要去存储一次数据库，防止数据几万条数据在内存，容易OOM</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (list.size() &gt;= BATCH_COUNT) &#123;</span><br><span class=\"line\">            saveData();</span><br><span class=\"line\">            <span class=\"comment\">// 存储完成清理 list</span></span><br><span class=\"line\">            list.clear();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 所有数据解析完成了 都会来调用</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> context</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfterAllAnalysed</span><span class=\"params\">(AnalysisContext context)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里也要保存数据，确保最后遗留的数据也存储到数据库</span></span><br><span class=\"line\">        saveData();</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;所有数据解析完成！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 加上存储数据库</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">saveData</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;&#123;&#125;条数据，开始存储数据库！&quot;</span>, list.size());</span><br><span class=\"line\">        demoDAO.save(list);</span><br><span class=\"line\">        LOGGER.info(<span class=\"string\">&quot;存储数据库成功！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>读取测试：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.lxki;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.EasyExcel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.ExcelReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.excel.read.metadata.ReadSheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.jupiter.api.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> IRVING QQ:2362766003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@create</span> 2021-06-22 16:57</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">EasyExcelRead</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成文件路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;E:\\\\workspace\\\\IdeaProjects\\\\POI-EasyExcel\\\\lxki-easyexcel\\\\&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 最简单的读</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class=\"doctag\">@link</span> DemoData&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class=\"doctag\">@link</span> DemoDataListener&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;3. 直接读即可</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">simpleRead</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> PATH + <span class=\"string\">&quot;easyexcel07.xlsx&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span></span><br><span class=\"line\">        EasyExcel.read(fileName, DemoData.class, <span class=\"keyword\">new</span> <span class=\"title class_\">DemoDataListener</span>()).sheet().doRead();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"注意：-1\"><a href=\"#注意：-1\" class=\"headerlink\" title=\"注意：\"></a>注意：</h4><ul>\n<li>如果需要操作 <code>03</code> 版本的 <code>excel</code>，需要在读写操作时传入 <code>excelType</code> 参数</li>\n</ul>\n<p>最终的项目结构：</p>\n<img src=\"https://my-typora-oss.oss-cn-shanghai.aliyuncs.com/image-master/20210622175228.png\" alt=\"image-20210622175227995\" style=\"zoom:50%;\" />\n","categories":[{"name":"后端开发","path":"api/categories/后端开发.json"}],"tags":[{"name":"技巧","path":"api/tags/技巧.json"},{"name":"笔记","path":"api/tags/笔记.json"}]}